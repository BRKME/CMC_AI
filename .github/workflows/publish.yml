name: Publish News (Every hour)

on:
  schedule:
    # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π —á–∞—Å
    - cron: '0 * * * *'
  workflow_dispatch:

jobs:
  publish-news:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: |
        pip install requests
        
    - name: Publish next news (PUBLISH MODE)
      timeout-minutes: 5
      env:
        MODE: publish
      run: python parser.py
    
    - name: Commit updated queue
      run: |
        git config --local user.email "github-actions[bot]@users.noreply.github.com"
        git config --local user.name "github-actions[bot]"
        git add news_queue.json
        git commit -m "üì§ Published news - $(date '+%Y-%m-%d %H:%M:%S')" || echo "No changes to commit"
        git push || echo "Nothing to push"
        
    - name: Show workflow info
      if: always()
      run: |
        echo "‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
        echo "üì§ –ù–æ–≤–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Telegram"
        echo "‚è∞ –°–ª–µ–¥—É—é—â–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ 1 —á–∞—Å"
